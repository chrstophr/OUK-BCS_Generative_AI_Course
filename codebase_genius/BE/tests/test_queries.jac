import from analyzer_utils { get_callers, get_callees, get_file_entities }
import json;

with entry {
    # Load the analysis data
    with open("outputs/analyzer_output.json", "r") as f {
        data = json.load(f);
    }
    
    call_graph = data.get("call_graph", {});
    files = data.get("files", []);
        print("üìÅ Files analyzed:");

    for file_info in files {
        fname = file_info.get("file", "?");
        fcount = len(file_info.get("functions", []));
        ccount = len(file_info.get("classes", []));
        print(f"  {fname}: {ccount} classes, {fcount} functions");
    }
    
    # Show which files DO have content
    print("‚úÖ Files with entities:");
    for file_info in files {
        if len(file_info.get("functions", [])) > 0 or len(file_info.get("classes", [])) > 0 {
            print(f"  {file_info.get('file', '?')}");
        }
    }

    # Test queries
    print("üß™ Testing Query Functions\n");
    
    # Test 1: Who calls run_analysis?
    callers = get_callers("run_analysis", call_graph);
    print(f"1Ô∏è‚É£ Callers of 'run_analysis': {callers}");
    
    # Test 2: What does execute_analysis call?
    callees = get_callees("execute_analysis", call_graph);
    print(f"2Ô∏è‚É£ 'execute_analysis' calls: {callees}");
    
    # Test 3: Get entities from main.jac
    entities = get_file_entities("main.jac", files);
    print(f"3Ô∏è‚É£ main.jac has {len(entities.get('classes', []))} classes, {len(entities.get('functions', []))} functions");
}